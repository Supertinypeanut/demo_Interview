# JS 运行机制

### 如何理解单线程
* JS是单线程，同一时间只能做一件事
* 异步。node叫非阻塞IO。

### 什么是任务队列
* 事件队列：任务队列。分为同步任务、异步任务。加载完JS，整个线程优先处理同步任务，再处理异步任务。无论你的同步有多少，异步多及时。都是这样。也有同步队列，和异步队列。
* node叫事件环机制，就是我理解的事件调度中心，优先处理先来用户的请求。
* 同步任务，或者异步返回一个无限循环，后面的任务都会被阻塞。
* JS有个timer模块，遇到time函数，会记住函数的执行时机开始倒计时，到了该执行的时间后，才把函数插入异步队列。

### 什么是Event loop 事件循环
* 【同步队列】，执行完成时，i=4,然后异步队列没有函数，timer等待时间到达，就是把函数推入异步队列，再等待一个【事件循环】的东西，再开始执行异步队列，所有是4个4.
```
for (var i = 0; i < 4; i++) {
  setTimeout(function () {
    console.log(i);  // 4*4
  },0);
}
```
* 【事件循环】：先把【同步队列】的函数放【运行栈】上执行，执行完成，有个【东西】就去看【异步队列】上有没有函数，timer模块把到时间的函数，放入【异步队列】，这个【东西】就会把【异步队列】的函数拿到运行栈上执行，执行完成后，再次重复前面的过程。这个【东西】和返回查看同步队列和异步的过程，叫事件循环。

### 异步任务
* SetTimeout/setinterval
* DOM的事件：浏览器有单独模块去接受这个函数，GUI监听用户点击某个按钮触发函数的时候，这个模块就会把这个函数推到【异步队列】中，【事件循环】会监测、拿走、执行这个函数。
* ES6中的promise。


